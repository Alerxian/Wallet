# Security and Risk Specification

## 1. 目标

定义资金安全与风控基线，确保从 MVP 到 Production 的安全演进可执行、可审计、可响应。

## 2. 威胁模型（简版）

- 认证风险：重放、伪造、会话劫持
- 交易风险：重复提交、参数篡改、异常高频
- 服务风险：接口滥用、依赖故障、配置泄露
- 数据风险：索引延迟、不一致、审计缺失
- 运维风险：告警缺失、故障响应慢

## 3. 分阶段安全要求

### Demo+

- 参数校验、基础链上校验

### MVP（必须）

- SIWE Nonce 防重放 + 时效验证
- 鉴权中间件
- 限流策略（用户/IP/接口）
- 关键交易审计日志
- 异常交易告警（频率/失败率）

### Beta（必须）

- 风控规则可配置
- 告警分级 + 值班
- 故障降级策略
- 周期性安全回归

### Production（必须）

- 安全事件响应 SOP
- 风险策略持续迭代机制
- 发布前安全签署
- 高危行为自动阻断

## 4. 控制清单

- SC-AUTH-01：SIWE 时效验证
- SC-AUTH-02：Nonce 防重放
- SC-AUTH-03：会话过期策略
- SC-TRADE-01：参数二次校验
- SC-TRADE-02：重复提交拦截
- SC-TRADE-03：高频限流
- SC-AUDIT-01：交易审计日志
- SC-AUDIT-02：链路追踪ID贯穿
- SC-OPS-01：敏感配置加密管理
- SC-OPS-02：密钥轮换计划

## 5. 指标阈值（建议）

- 未授权请求拦截率 = 100%
- 关键交易可审计率 = 100%
- 高风险异常检测召回率 >= 95%
- 发布窗口 P0 安全事件 = 0

## 6. 应急机制

- 分级：P0/P1/P2
- 响应时限：P0 15分钟，P1 30分钟
- 止损动作：限流提升、降级、临时关停高危功能
- 复盘：24小时初报，72小时整改计划
