# 最终验收与发布检查模板（Final Acceptance & Release）

你现在进入全量收口模式。
目标：在所有阶段实施完成后，进行统一验收、风险确认、发布决策与回滚准备。

---

## 0) 输入上下文

- 规划文档：1.md
- 阶段执行记录：2.md（各阶段输出）
- 当前代码分支：<branch-name>
- 发布目标环境：<dev/staging/prod>

---

## 1) 全量完成度核对（对照 1.md）

请逐项核对并标记：

- [ ] 核心功能保持可用（市场列表/详情/买卖/WalletConnect）
- [ ] 功能增强目标达成（至少完成 P0 增强项）
- [ ] UI/UX 提升达成（视觉一致、交互完整、关键流程可用）
- [ ] 核心功能无回归（市场列表/详情/买卖/WalletConnect）
- [ ] API 兼容性满足预期（请求/响应 schema、错误处理）
- [ ] 状态管理符合约束（无不必要全局状态，无大型新状态库）
- [ ] 文档与代码一致（README/注释/运行说明更新）

---

## 2) 最终测试门禁（必须执行并通过）

必须执行：

- npm run typecheck
- npm run test

如项目有额外命令，也请执行：

- <例如：npm run lint>
- <例如：npm run build 或 expo 导出检查>

### 失败处理规则

- 任何门禁失败都不得进入发布
- 必须输出：失败原因 -> 修复动作 -> 重跑结果
- 直到全部通过后才能继续

---

## 3) 关键业务回归（手测清单）

请逐项验证并记录结果（通过/失败/备注）：

- [ ] 钱包连接与登录（WalletConnect + SIWE）
- [ ] 市场列表加载、分页/刷新、异常提示
- [ ] 市场搜索、筛选、排序（如已实现）
- [ ] 市场详情展示与数据一致性
- [ ] 买入/卖出主流程（成功、失败、重试）
- [ ] 交易状态刷新与本地 pending 同步
- [ ] 持仓与活动流展示（如适用）
- [ ] 收藏/最近浏览（如已实现）
- [ ] 弱网/断网下的提示与恢复

---

## 4) UI/UX 验收（体验清单）

- [ ] 视觉统一（色彩、间距、排版、组件风格一致）
- [ ] 加载态/空态/错误态完整
- [ ] 触控反馈与动效节奏自然
- [ ] 文案清晰、按钮语义明确
- [ ] 小屏与大屏显示正常（至少 2 种设备尺寸）
- [ ] 可访问性基础达标（对比度、可点击区域、可读性）

---

## 5) 非功能检查（稳定性与可维护性）

- [ ] 无新增明显性能退化（首屏、列表滚动、切页）
- [ ] 无高风险日志泄露（敏感信息、私钥、token）
- [ ] 错误边界与异常处理覆盖关键路径
- [ ] 模块职责单一、无明显循环依赖
- [ ] 关键路径代码具备最小必要测试

---

## 6) 发布与回滚准备

### 发布前信息

- 发布版本：<version>
- 变更摘要：<3-5 条>
- 风险等级：<低/中/高>
- 影响范围：<页面/流程>

### 回滚方案（必须可执行）

- 代码回滚点：<commit/tag>
- 配置回滚项：<env/feature flag>
- 数据兼容说明：<如有>
- 回滚触发条件：<出现哪些问题立即回滚>

---

## 7) 最终结论（固定输出格式）

请严格按以下结构输出最终报告：

1. 验收结论：通过 / 有条件通过 / 不通过
2. 门禁结果：typecheck/test/...
3. 回归结果：通过项 / 失败项 / 风险项
4. 发布建议：建议发布 / 暂缓发布
5. 必改项（若有）：最多 5 条，按优先级
6. 回滚预案确认：已确认 / 未确认 + 缺失点

---

## 8) 停止条件

满足以下全部条件才可停止：

- 所有测试门禁通过
- 核心业务回归通过
- 风险与回滚方案明确
- 已输出最终验收报告
